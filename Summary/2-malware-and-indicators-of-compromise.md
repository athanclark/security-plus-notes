Malware & Indicators of Compromise
==========================================

Malware is classified by its primary threat:

- _circulation_ - spreading rapidly, i.e. worms & viruses
- _infection_ - how it embeds itself
- _concealment_ - how it avoids detection
- _capabilities_ - can it launch nukes?
  - collect & delete data, modify security, launch attacks

### Virus

> Reproduces on a host machine by attaching itself to files, relies on users to spread the files.

- _boot sector virus_ - bypasses operating system
- _pharming_ - changes HOSTS file
- _program virus_ - infects an executable
- _script virus_ - common in browsers and systems - python
- _macro_ - series of instructions as a single command, common in Microsoft Office
- _appender infection_ - virus code added at the end of the file
- _armored virus_ - employing advanced techniques to avoid indication, not limited to encryption
- _swiss-cheese infection_ - virus code is scrambled in parts, to be later assembled. Parts may be encrypted.
- _split infection_ - executable is segmented in host executable, with GOTO statements to each part
- _mutations_
  - _oligomorphic_ - predefined mutation set
  - _polymorphic_ - completely changes on every execution
  - _metamorphic_ - rewrites its own code

**Trojan Horse**: Claims to be a program with a specific intent, but internally has malicious intent.
Must be executed and approved by the user.

**Remote-Access Trojan Horse** (RAT): A Trojan that opens a backdoor

### Worms

> Directly infect other hosts on a network without being manually spread by users

----------------------------------

## Types of Malware

- _Ransomware_ - demands payment to return access to computer
  - Phony "license expired" notice
  - Crypto-Malware - encrypts your files, making them unreadable until payment is received
- _Rootkit_ - hijacks the operating system, and hides from detection
- _Spyware & Keyloggers_ - collect info & credentials
- _Adware_ - popups
- _Logic Bombs_ - launches attack when a specific event happens
- _Botnets** - spam, spreads malware, manipulates polls

----------------------------------

## Social Engineering

> Relies on the weakness of individuals - psychological and physical, and tries to gain their trust

- provide a reason
- project confidence
- evasion & diversion
- make them laugh

### Principals

- Authority - the guy in charge, or related to them
- Intimidation - if you don't help, payroll checks won't be charged
- Consensus / Social Proof - your coworker did X for me last week
- Scarcity - act now or the offer will expire
- Urgency - act quickly, don't think
- Familiarity - we have common friends
- Trust - I'm from IT, I'm here to help

### Common Tactics

> Often impersonating someone with authority

**Phishing**: tricks the user into giving private information

- _spear phishing_ - specific individuals
- _whaling_ - specific _wealthy_ individuals
- _vishing** - phishing over the phone

> > 97% of attacks start with phishing

**Hoax**: A false warning by impersonators of the "IT Department**

**Watering Hole**: Common spot for victims

**Dumpster Diving**: Searching for patterns to improve impersonation, or credentials if they're lucky

**Tailgating**: "Hey, could you hold the door for me?" - Mantraps and airlocks and prevent this.

**Shoulder Surfing**: Watching the PIN over someone's shoulder
